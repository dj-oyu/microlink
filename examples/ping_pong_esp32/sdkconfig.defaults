# MicroLink Ping Pong Example - ESP32 (no PSRAM) optimized config
#
# This configuration is optimized for standard ESP32 boards without PSRAM
# such as HiLetgo ESP-32S, ESP32-WROOM-32D, ESP32-DevKitC, etc.
#
# Memory is tight! The 64KB coordination buffer will come from SRAM.
# Reduce MICROLINK_MAX_PEERS in menuconfig if you run out of memory.

# Required ESP-IDF components
CONFIG_ESP_TLS_USING_MBEDTLS=y
CONFIG_MBEDTLS_SSL_PROTO_TLS1_2=y
CONFIG_MBEDTLS_CERTIFICATE_BUNDLE=y
CONFIG_MBEDTLS_CERTIFICATE_BUNDLE_DEFAULT_CMN=y

# HTTP/2 support
CONFIG_ESP_HTTP_CLIENT_ENABLE_HTTPS=y
CONFIG_NGHTTP_ENABLE=y

# Networking - reduced buffer sizes for memory-constrained ESP32
CONFIG_LWIP_IPV4=y
CONFIG_LWIP_DHCP_DOES_ARP_CHECK=n
CONFIG_LWIP_IP4_FRAG=y
CONFIG_LWIP_IP4_REASSEMBLY=y
CONFIG_LWIP_TCP_MSS=1436
CONFIG_LWIP_TCP_SND_BUF_DEFAULT=4096
CONFIG_LWIP_TCP_WND_DEFAULT=4096
CONFIG_LWIP_TCP_RECVMBOX_SIZE=6
CONFIG_LWIP_UDP_RECVMBOX_SIZE=6

# Memory optimization for ESP32 without PSRAM
CONFIG_ESP_MAIN_TASK_STACK_SIZE=6144

# NO PSRAM - standard ESP32 uses SRAM only
# CONFIG_SPIRAM is intentionally NOT set

# MicroLink memory optimization for non-PSRAM ESP32
# 24KB buffer instead of 64KB to fit in limited SRAM (~266KB total)
CONFIG_MICROLINK_COORD_BUFFER_SIZE_KB=24
CONFIG_MICROLINK_MAX_PEERS=8

# Logging - reduce to INFO to save memory
CONFIG_LOG_DEFAULT_LEVEL_INFO=y
CONFIG_LOG_MAXIMUM_LEVEL_INFO=y

# Flash size and partition table
CONFIG_ESPTOOLPY_FLASHSIZE_4MB=y
CONFIG_PARTITION_TABLE_SINGLE_APP_LARGE=y

# WiFi - reduced buffers for memory optimization
CONFIG_ESP_WIFI_STATIC_RX_BUFFER_NUM=6
CONFIG_ESP_WIFI_DYNAMIC_RX_BUFFER_NUM=16
CONFIG_ESP_WIFI_TX_BUFFER_TYPE=1
CONFIG_ESP_WIFI_DYNAMIC_TX_BUFFER_NUM=16
CONFIG_ESP_WIFI_AMPDU_TX_ENABLED=n
CONFIG_ESP_WIFI_AMPDU_RX_ENABLED=n

# FreeRTOS
CONFIG_FREERTOS_HZ=1000

# mbedTLS memory optimization
CONFIG_MBEDTLS_ASYMMETRIC_CONTENT_LEN=y
CONFIG_MBEDTLS_SSL_IN_CONTENT_LEN=8192
CONFIG_MBEDTLS_SSL_OUT_CONTENT_LEN=4096
CONFIG_MBEDTLS_DYNAMIC_BUFFER=y
